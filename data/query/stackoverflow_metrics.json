{
    "id": "stackoverflow_metrics",
    "description": "Stackoverflow Metrics",
    "default": {
        "sys_content_type": [ "stackoverflow_question" ]
    },
    "template" : "{\n    \"size\":  0,\n    \"query\": {\n        \"filtered\": {\n            \"filter\": {\n                \"and\": [\n                    {\n                        \"or\": [\n                            {{#tag}}\n                            { \"term\": { \"sys_tags\": \"{{.}}\" }},\n                            {{/tag}}\n                            {}\n                        ]\n                    }\n                    {{#date_from}}\n                    ,{\n                        \"range\": {\n                            \"sys_created\": {\n                                \"gte\": \"{{date_from}}\",\n                                \"time_zone\" : \"{{timezone_offset}}{{^timezone_offset}}America/New_York{{/timezone_offset}}\"\n                            }\n                        }\n                    }\n                    {{/date_from}}\n                    {{#date_to}}\n                    ,{\n                        \"range\": {\n                            \"sys_created\": {\n                                \"lt\": \"{{date_to}}\",\n                                \"time_zone\" : \"{{timezone_offset}}{{^timezone_offset}}America/New_York{{/timezone_offset}}\"\n                            }\n                        }\n                    }\n                    {{/date_to}}\n                ]\n            }\n        }\n    },\n    \"aggs\": {\n        \"time_agg\": {\n            \"date_histogram\": {\n                \"field\": \"sys_created\",\n                \"order\": { \"_key\": \"asc\" },\n                \"interval\" : \"{{interval}}{{^interval}}month{{/interval}}\",\n                \"format\": \"{{bucket_key_format}}{{^bucket_key_format}}yyyy-MM{{/bucket_key_format}}\",\n                \"pre_zone\" : \"{{timezone_offset}}{{^timezone_offset}}America/New_York{{/timezone_offset}}\"\n            },\n            \"aggs\": {\n                \"answered\": {\n                    \"filter\" : { \"range\" : { \"answer_count\" : { \"gt\" : 0 } } }\n                },\n                \"correct_answer\": {\n                    \"filter\" : { \"term\" : { \"is_answered\" : \"true\"} }\n                }, \n                \"view_count\": {\n                    \"stats\" : { \"field\" : \"view_count\" }\n                },\n                \"time_to_answer_mins\": {\n                    \"stats\" : { \"field\" : \"time_to_answer_mins\" }\n                },\n                \"time_to_correct_answer_mins\": {\n                    \"stats\" : { \"field\" : \"time_to_correct_answer_mins\" }\n                }\n            }\n        }\n    }\n}"

}
