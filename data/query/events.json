{
  "id": "events",
  "default": {
    "sys_type": "event"
  },
  "description": "List events. Accepts the following parameters: 'region', 'product', 'solution', 'format'.",
  "template": "      {\n        \"size\": 0,\n        \"query\": {\n          \"filtered\": {\n            \"filter\": {\n              \"and\": [\n                {\n                  \"range\": {\n                    \"end_date\": {\n                      \"gte\": \"now-1d\"\n                    }\n                  }\n                }\n                {{#region}}\n                ,{\n                  \"term\": {\n                    \"region\": \"{{region}}\"\n                  }\n                }\n                {{/region}}\n                {{#product}}\n                ,{\n                  \"term\": {\n                    \"target_product\": \"{{product}}\"\n                  }\n                }\n                {{/product}}\n                {{#solution}}\n                ,{\n                  \"term\": {\n                    \"solution\": \"{{solution}}\"\n                  }\n                }\n                {{/solution}}\n                {{#format}}\n                ,{\n                  \"term\": {\n                    \"format\": \"{{format}}\"\n                  }\n                }\n                {{/format}}\n              ]\n            }\n          }\n        },\n        \"aggs\": {\n          \"months_by_start_date\": {\n            \"date_histogram\": {\n              \"field\": \"start_date\",\n              \"interval\": \"month\",\n              \"format\": \"MMMM YYYY\",\n              \"order\": {\n                \"_key\": \"asc\"\n              }\n            },\n            \"aggs\": {\n              \"events\": {\n                \"top_hits\": {\n                  \"sort\": [\n                    \"start_date\",\n                    \"end_date\"\n                  ],\n                  \"_source\": {\n                    \"include\": [\n                      \"start_date\",\n                      \"end_date\",\n                      \"sys_title\",\n                      \"sys_description\",\n                      \"sys_url_view\",\n                      \"image\",\n                      \"format\",\n                      \"sys_id\"\n                    ]\n                  },\n                  \"size\": 500\n                }\n              }\n            }\n          },\n          \"months_by_end_date\": {\n            \"date_histogram\": {\n              \"field\": \"end_date\",\n              \"interval\": \"month\",\n              \"format\": \"MMMM YYYY\",\n              \"order\": {\n                \"_key\": \"asc\"\n              }\n            },\n            \"aggs\": {\n              \"events\": {\n                \"top_hits\": {\n                  \"sort\": [\n                    \"start_date\",\n                    \"end_date\"\n                  ],\n                  \"_source\": {\n                    \"include\": [\n                      \"start_date\",\n                      \"end_date\",\n                      \"sys_title\",\n                      \"sys_description\",\n                      \"sys_url_view\",\n                      \"image\",\n                      \"format\",\n                      \"sys_id\"\n                    ]\n                  },\n                  \"size\": 500\n                }\n              }\n            }\n          },\n          \"format_global\": {\n            \"global\": {},\n            \"aggs\": {\n              \"format_filter\": {\n                \"filter\": {\n                  \"range\": {\n                    \"end_date\": {\n                      \"gte\": \"now-1d\"\n                    }\n                  }\n                },\n                \"aggs\": {\n                  \"format\": {\n                    \"terms\": {\n                      \"field\": \"format\",\n                      \"order\": {\n                        \"_term\": \"asc\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          },\n          \"region_global\": {\n            \"global\": {},\n            \"aggs\": {\n              \"region_filter\": {\n                \"filter\": {\n                  \"range\": {\n                    \"end_date\": {\n                      \"gte\": \"now-1d\"\n                    }\n                  }\n                },\n                \"aggs\": {\n                  \"region\": {\n                    \"terms\": {\n                      \"field\": \"region\",\n                      \"order\": {\n                        \"_term\": \"asc\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          },\n          \"product_global\": {\n            \"global\": {},\n            \"aggs\": {\n              \"product_filter\": {\n                \"filter\": {\n                  \"range\": {\n                    \"end_date\": {\n                      \"gte\": \"now-1d\"\n                    }\n                  }\n                },\n                \"aggs\": {\n                  \"product\": {\n                    \"terms\": {\n                      \"field\": \"target_product\",\n                      \"order\": {\n                        \"_term\": \"asc\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          },\n          \"solution_global\": {\n            \"global\": {},\n            \"aggs\": {\n              \"solution_filter\": {\n                \"filter\": {\n                  \"range\": {\n                    \"end_date\": {\n                      \"gte\": \"now-1d\"\n                    }\n                  }\n                },\n                \"aggs\": {\n                  \"solution\": {\n                    \"terms\": {\n                      \"field\": \"solution\",\n                      \"order\": {\n                        \"_term\": \"asc\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }"
}
