{
  "id": "developer_materials",
  "description": "Developer material finder. Accepts the following parameters: 'from', 'query', 'size10', 'size15', 'size20', 'size25', 'level', 'tag', 'publish_date', 'activity_interval','activity_date_from', 'activity_date_to', 'rating', 'sys_type', 'project', 'randomized', 'seed', 'newFirst', 'oldFirst'",
  "default": {
    "sys_content_type": [ "jbossdeveloper_quickstart","jbossdeveloper_demo","jbossdeveloper_bom","jbossdeveloper_archetype","jbossdeveloper_example","jbossdeveloper_vimeo","jbossdeveloper_youtube","jbossdeveloper_book","rht_knowledgebase_article","rht_knowledgebase_solution","jbossorg_blog" ]
  },
  "template": "{\n      \"from\": {{#from}}{{from}}{{/from}}{{^from}}0{{/from}},\n      \"size\": 10,\n      {{#size15}}\"size\": 15,{{/size15}}\n      {{#size20}}\"size\": 20,{{/size20}}\n      {{#size25}}\"size\": 25,{{/size25}}\n      {{#size50}}\"size\": 50,{{/size50}}\n      {{#size100}}\"size\": 100,{{/size100}}\n      \"fields\": [\n        \"contributors\", \"duration\", \"experimental\", \"github_repo_url\", \"level\", \"sys_author\", \"sys_contributors\",\n        \"sys_created\", \"sys_description\", \"sys_rating_avg\", \"sys_rating_num\", \"sys_title\", \"sys_type\",\n        \"sys_url_view\", \"thumbnail\", \"sys_tags\", \"target_product\"\n      ],\n      {{#randomized}}\n      \"query\": {\n        \"function_score\": {\n      {{/randomized}}\n          \"query\": {\n            \"filtered\": {\n              {{#query}}\n              \"query\": {\n                \"simple_query_string\": {\n                  \"query\": \"{{query}}\",\n                  \"fields\": [\n                    \"sys_description\", \"sys_tags^1.5\", \"sys_contributors.fulltext\", \"sys_project_name^2.0\",\"sys_title^2.5\"\n                  ]\n                }\n              },\n              {{/query}}\n              \"filter\": {\n                \"and\": {\n                  \"filters\": [\n                    {{#level}}\n                    {\n                      \"term\": {\n                        \"level\": \"{{level}}\"\n                      }\n                    },\n                    {{/level}}\n                    {{#tag}}\n                    {\n                      \"term\": {\n                        \"sys_tags\": [\"{{.}}\"]\n                      }\n                    },\n                    {{/tag}}\n                    {{#publish_date}}\n                    {\n                      \"range\": {\n                        \"sys_created\": {\n                          \"gte\": \"{{publish_date}}\"\n                        }\n                      }\n                    },\n                    {{/publish_date}}\n          {{#activity_interval}}\n                    {\n                      \"range\": {\n                        \"sys_activity_dates\": {\n                          \"gte\": \"{{activity_interval}}\"\n                        }\n                      }\n                    },\n                    {{/activity_interval}}\n          {{#activity_date_from}}\n                    {\n                      \"range\": {\n                        \"sys_activity_dates\": {\n                          \"gte\": \"{{activity_date_from}}\"\n                        }\n                      }\n                    },\n                    {{/activity_date_from}}\n                    {{#activity_date_to}}\n                    {\n                      \"range\": {\n                        \"sys_activity_dates\": {\n                          \"lte\": \"{{activity_date_to}}\"\n                        }\n                      }\n                    },\n                    {{/activity_date_to}}\n                    {{#rating}}\n                    {\n                      \"range\": {\n                        \"sys_rating_avg\": {\n                          \"gte\": \"{{rating}}\"\n                        }\n                      }\n                    },\n                    {{/rating}}\n                    {\n                      \"or\": [\n                        {{#sys_type}}\n                        {\n                          \"script\": {\n                            \"script\": \"(format_selection == 'quickstart_early_access' && _source.sys_type == 'quickstart' && _source.experimental != undefined && _source.experimental != null && _source.experimental === true) || (format_selection == 'quickstart' && _source.sys_type == format_selection && _source.experimental !== true) || (format_selection != 'quickstart' && format_selection != 'quickstart_early_access' && _source.sys_type == format_selection)\",\n                            \"params\": {\n                              \"format_selection\": \"{{.}}\",\n                              \"lang\": \"js\"\n                            }\n                          }\n                        },\n                        {{/sys_type}}\n                        {}\n                      ]\n                    },\n                    {\n                      \"or\": [\n                        {{#project}}\n                        {\n                            \"term\": { \"sys_project\": \"{{.}}\" }\n                        },\n                        {{/project}}\n                        {}\n                      ]\n                    },\n                    {\n                      \"terms\": {\n                        \"sys_content_provider\": [\n                          \"jboss-developer\",\"jbossorg\", \"rht\"\n                        ]\n                      }\n                    }\n                  ]\n                }\n              }\n            }\n          }\n      {{#randomized}}\n          ,\"functions\": [\n            {\n              \"random_score\": { \"seed\": \"{{#seed}}{{seed}}{{/seed}}{{^seed}}default{{/seed}}\" }\n            }\n          ]\n        }\n      }\n      {{/randomized}}\n      {{^randomized}}\n      ,\"sort\": [\n        {{#newFirst}} { \"sys_created\": \"desc\" }, {{/newFirst}}\n        {{#oldFirst}} { \"sys_created\": \"asc\" }, {{/oldFirst}}\n        \"_score\"\n      ]\n      {{/randomized}}\n      ,\n      \"aggregations\": {\n        \"format\": {\n          \"global\": {},\n          \"aggregations\": {\n            \"count_with_filters\": {\n              \"filter\": {\n                \"and\": {\n                  \"filters\": [\n                    {{#query}}\n                    {\n                      \"query\": {\n                        \"simple_query_string\": {\n                          \"query\": \"{{query}}\",\n                          \"fields\": [\n                            \"sys_description\", \"sys_tags^1.5\", \"sys_contributors.fulltext\", \"sys_project_name^2.0\", \"sys_title^2.5\"\n                          ]\n                        }\n                      }\n                    },\n                    {{/query}}\n                    {{#level}}\n                    {\n                      \"term\": { \"level\": \"{{level}}\" }\n                    },\n                    {{/level}}\n                    {{#tag}}\n                    {\n                      \"term\": { \"sys_tags\": [\"{{.}}\"] }\n                    },\n                    {{/tag}}\n                    {{#publish_date}}\n                    {\n                      \"range\": {\n                        \"sys_created\": { \"gte\": \"{{publish_date}}\" }\n                      }\n                    },\n                    {{/publish_date}}\n         {{#activity_interval}}\n                    {\n                      \"range\": {\n                        \"sys_activity_dates\": {\n                          \"gte\": \"{{activity_interval}}\"\n                        }\n                      }\n                    },\n                    {{/activity_interval}}\n           {{#activity_date_from}}\n                    {\n                      \"range\": {\n                        \"sys_activity_dates\": {\n                          \"gte\": \"{{activity_date_from}}\"\n                        }\n                      }\n                    },\n                    {{/activity_date_from}}\n                    {{#activity_date_to}}\n                    {\n                      \"range\": {\n                        \"sys_activity_dates\": {\n                          \"lte\": \"{{activity_date_to}}\"\n                        }\n                      }\n                    },\n                    {{/activity_date_to}}\n                    {{#rating}}\n                    {\n                      \"range\": {\n                        \"sys_rating_avg\": { \"gte\": \"{{rating}}\"}\n                      }\n                    },\n                    {{/rating}}\n                    {\n                      \"or\": [\n                        {{#sys_type}}\n                        {\n                          \"script\": {\n                            \"script\": \"(format_selection == 'quickstart_early_access' && _source.sys_type == 'quickstart' && _source.experimental != undefined && _source.experimental != null && _source.experimental === true) || (format_selection == 'quickstart' && _source.sys_type == format_selection && _source.experimental !== true) || (format_selection != 'quickstart' && format_selection != 'quickstart_early_access' && _source.sys_type == format_selection)\",\n                            \"params\": {\n                              \"format_selection\": \"{{.}}\",\n                              \"lang\": \"js\"\n                            }\n                          }\n                        },\n                        {{/sys_type}}\n                        {}\n                      ]\n                    },\n                    {\n                      \"or\": [\n                        {{#project}}\n                        {\n                          \"term\": { \"sys_project\": \"{{.}}\" }\n                        },\n                        {{/project}}\n                        {}\n                      ]\n                    },\n                    {\n                      \"terms\": {\n                        \"sys_content_provider\": [\n                          \"jboss-developer\",\"jbossorg\", \"rht\"\n                        ]\n                      }\n                    }\n                  ]\n                }\n              },\n              \"aggregations\": {\n                \"format_counts\": {\n                  \"terms\": {\n                    \"script\": \"_source.sys_type == 'quickstart' ? ( _source.experimental != undefined && _source.experimental != null && _source.experimental === true ? _source.sys_type + '_early_access' : _source.sys_type ) : _source.sys_type\",\n                    \"lang\": \"js\",\n                    \"size\": 100\n                  }\n                }\n              }\n            },\n            \"count_without_filters\": {\n              \"filter\": {\n                \"and\": {\n                  \"filters\": [\n                    {\n                      \"terms\": {\n                        \"sys_content_provider\": [\n                          \"jboss-developer\",\"jbossorg\", \"rht\"\n                        ]\n                      }\n                    }\n                  ]\n                }\n              },\n              \"aggregations\": {\n                \"format_counts\": {\n                  \"terms\": {\n                    \"script\": \"_source.sys_type == 'quickstart' ? ( _source.experimental != undefined && _source.experimental != null && _source.experimental === true ? _source.sys_type + '_early_access' : _source.sys_type ) : _source.sys_type\",\n                    \"lang\": \"js\",\n                    \"size\": 100\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }"
}
